DROP TABLE IF EXISTS PESSOAS_TAREFAS
DROP TABLE IF EXISTS USUARIOS_TAREFAS
DROP TABLE IF EXISTS PESSOAS
DROP TABLE IF EXISTS TAREFAS
DROP TABLE IF EXISTS USUARIOS

CREATE TABLE USUARIOS (
	ID INT NOT NULL IDENTITY CONSTRAINT PK_USUARIOS_ID PRIMARY KEY,
	DATA_CRIACAO DATETIME NOT NULL,
	NOME VARCHAR(100) NOT NULL,
	EMAIL VARCHAR(100) NOT NULL,
	SENHA VARCHAR(20) NOT NULL,
	PAPEL VARCHAR(20) NOT NULL
)

CREATE TABLE TAREFAS (
	ID INT NOT NULL IDENTITY CONSTRAINT PK_TAREFAS_ID PRIMARY KEY,
	DATA_CRIACAO DATETIME NOT NULL,
	TITULO VARCHAR(100) NOT NULL,
	DATA_INICIO DATETIME NOT NULL,
	DATA_FIM DATETIME NOT NULL,
	ID_CRIADOR INT NOT NULL CONSTRAINT FK_USUARIOS_ID FOREIGN KEY REFERENCES USUARIOS (ID)
)

CREATE TABLE USUARIOS_TAREFAS (
	ID INT NOT NULL IDENTITY CONSTRAINT PK_USUARIOS_TAREFAS_ID PRIMARY KEY,
	ID_USUARIO INT NOT NULL CONSTRAINT FK_USU_TAR_USUARIOS_ID FOREIGN KEY REFERENCES USUARIOS (Id),
	ID_TAREFA INT NOT NULL CONSTRAINT FK_USU_TAR_TAREFAS_ID FOREIGN KEY REFERENCES TAREFAS (Id)
)

INSERT INTO USUARIOS VALUES (GETDATE(), 'UsuTeste1', 'usuTeste1@email.com.br', 'MTIzNDU2', 'Admin')
INSERT INTO USUARIOS VALUES (GETDATE(), 'UsuTeste2', 'usuTeste2@email.com.br', 'MTIzNDU2', 'Comum')
INSERT INTO USUARIOS VALUES (GETDATE(), 'UsuTeste3', 'usuTeste3@email.com.br', 'MTIzNDU2', 'Comum')
INSERT INTO TAREFAS VALUES (GETDATE(), 'Criar aplicação', '26/04/2024 10:00:00', '26/04/2024 12:30:00', (SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste1'))
INSERT INTO TAREFAS VALUES (GETDATE(), 'Refatorar aplicação', '26/04/2024 14:00:00', '26/04/2024 16:00:00', (SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste1'))
INSERT INTO TAREFAS VALUES (GETDATE(), 'Complitar aplicação', '26/04/2024 17:30:00', '26/04/2024 18:00:00', (SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste3'))
INSERT INTO USUARIOS_TAREFAS VALUES ((SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste2'), (SELECT ID FROM TAREFAS WHERE TITULO = 'Criar aplicação'))
INSERT INTO USUARIOS_TAREFAS VALUES ((SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste2'), (SELECT ID FROM TAREFAS WHERE TITULO = 'Refatorar aplicação'))
INSERT INTO USUARIOS_TAREFAS VALUES ((SELECT ID FROM USUARIOS WHERE NOME = 'UsuTeste3'), (SELECT ID FROM TAREFAS WHERE TITULO = 'Complitar aplicação'))

SELECT*FROM USUARIOS
SELECT*FROM TAREFAS
SELECT*FROM USUARIOS_TAREFAS

SELECT*FROM USUARIOS U
INNER JOIN USUARIOS_TAREFAS UT ON U.ID = UT.ID_USUARIO
INNER JOIN TAREFAS T ON T.ID = UT.ID_TAREFA
